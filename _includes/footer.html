<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/js/all.min.js" integrity="sha256-KzZiKy0DWYsnwMF+X1DvQngQ2/FxF7MF3Ff72XcpuPs=" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js" integrity="sha512-s+xg36jbIujB2S2VKfpGmlC3T5V2TF3lY48DX7u2r9XzGzgPsa6wTpOQA7J9iffvdeBN0q9tKzRxVxw1JviZPg==" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@0.7.0"></script>
<script>
    $(window).ready(function(){
        $('#main').animate({opacity: 1}, 700);
    });

    // Chart defaults
    Chart.defaults.global.defaultFontFamily = "Lato";
    Chart.defaults.global.defaultFontSize = 14;

    // Unit Leaderboard
    {% assign unit_entries = (site.data.unitMileage) %}
    var unit_labels = []
    var unit_data = []
    
    {% for item in unit_entries limit:10 %}
        unit_labels.push("{{ item.Unit }}");
        unit_data.push({{ item.Total }});
    {% endfor %}

    // Create bar chart
    var unit_chart = document.getElementById('unit-lb').getContext("2d");
    var unitChart = new Chart(unit_chart, {
        type: 'horizontalBar',
        data: {
            labels: unit_labels,
            datasets: [{
                borderWidth: 2,
                borderColor: "transparent",
                backgroundColor: "#27DDCB",
                hoverBackgroundColor: "rgba(39,221,203, 0.80)",
                fill: true,
                lineTension: 0.1,
                data: unit_data
            }]
        },
        options: {
            legend: {
                display: false
            },
            tooltips: {
                callbacks: {
                    label: function(tooltipItem, data){
                        return "Mileage: " + tooltipItem.xLabel + ' km';
                    }
                },
                displayColors: false
            },
            scales: {
                yAxes: [{
                    gridLines: {
                        color: "rgba(0,0,0,0)",
                        display: false
                    }
                }],
                xAxes: [{
                    scaleLabel: {
                        display: true,
                        //labelString: "Mileage (KM)"
                    },
                    gridLines: {
                        display: false
                    },
                    ticks: {
                        display: false
                    }
                }]
            },
            plugins: {
                datalabels: {
                    color: "white",
                    anchor: 'end',
                    align: 'left',
                    font: {
                        size: 12
                    },
                    padding: 0
                }
            }
        }  
    });

    // Individual Leaderboard
    {% assign indiv_entries = (site.data.individualMileage) %}
    var indiv_labels = []
    var indiv_data = []

    {% for item in indiv_entries limit:10 %}
        indiv_labels.push("{{ item.Name }}");
        indiv_data.push({{ item.Total }});
    {% endfor %}

    // Create bar chart
    var indiv_chart = document.getElementById('indiv-lb').getContext("2d");
    var indivChart = new Chart(indiv_chart, {
        type: 'horizontalBar',
        data: {
            labels: indiv_labels,
            datasets: [{
                borderWidth: 2,
                borderColor: "transparent",
                backgroundColor: "#ee4c7c",
                hoverBackgroundColor: "rgba(238, 76, 124, 0.85)",
                fill: true,
                lineTension: 0.1,
                data: indiv_data
            }]
        },
        options: {
            legend: {
                display: false
            },
            tooltips: {
                callbacks: {
                    label: function(tooltipItem, data){
                        return "Mileage: " + tooltipItem.xLabel + ' km';
                    }
                },
                displayColors: false
            },
            scales: {
                yAxes: [{
                    gridLines: {
                        color: "rgba(0,0,0,0)",
                        display: false
                    }
                }],
                xAxes: [{
                    gridLines:{
                        color: "rgba(0,0,0,0)",
                        display: false
                    },
                    scaleLabel: {
                        display: true,
                        //labelString: "Mileage (KM)"
                    },
                    ticks: {
                        display: false
                    }
                }]
            },
            plugins: {
                datalabels: {
                    color: "white",
                    anchor: 'end',
                    align: 'left',
                    font: {
                        size: 12
                    },
                    padding: 0
                }
            }
        }
    });


</script>